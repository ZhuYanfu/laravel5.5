$(function () {
    //直接发送ajax请求，在success中组装图表数据，也在这里完成setOption的动作
    $.ajax({
        type: 'GET',
        url: "/score/getDataOfGraph",
        headers: {
            'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')
        },
        success: function(data){
            // console.log('data=>>>>');
            // console.log(data['name']);
            console.log(data['name']);
            console.log(data['score']);
            generateChart(data);
        },
        error: function(){
            alert('请求数据失败！');
        }
    });
    //生成图表单独做一个方法
    function generateChart(data){
        var bar = echarts.init(document.getElementById("echarts-bar-chart")),
        option = {
                title: {
                    text: "一年级12班成绩概览"
                },
                tooltip: {
                    trigger: "axis"
                },
                legend: {
                    data: ["总成绩", "姓名"]
                },
                grid: {
                    x: 100,
                    x2: 100,
                    y2: 30
                },
                calculable: !0,
                xAxis: [{
                    type: "category",
                    // data: ["马晓明", "赵玉林", "沈琦", "潘瑞", "吴Kris", "朱晓晓", "李继峰", "王米", "佀大钊"]
                    data: data['name']
                }],
                yAxis: [{
                    type: "value",
                    /*max: 300,
                    min: 250,
                    splitNumber: 10*/
                }],
                series: [{
                    name: "总成绩",
                    type: "bar",
                    // data: [285, 268, 269, 279.2, 298, 295, 289, 256, 279],
                    data: data['score'],
                    markPoint: {
                        data: [{
                            type: "max",
                            name: "最大值"
                        }, {
                            type: "min",
                            name: "最小值"
                        }]
                    },
                    markLine: {
                        data: [{
                            type: "average",
                            name: "平均值"
                        }]
                    }
                }]
            };
        bar.setOption(option), $(window).resize(bar.resize);
    }
});